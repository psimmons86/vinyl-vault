<%- include('../partials/header.ejs') %>

<div class="container">
  <div class="row">
    <div class="col s12 m8 offset-m2">
      <div class="card">
        <div class="card-content">
          <span class="card-title">Profile Settings</span>

          <% if (error) { %>
          <div class="card-panel red lighten-4 red-text text-darken-4">
            <%= error %>
          </div>
          <% } %>

          <form action="/records/settings" method="POST">
            <!-- Profile Picture Section -->
            <div class="section">
              <div class="row valign-wrapper">
                <div class="col s4 center-align">
                  <img
                    src="<%= user.profile?.avatarUrl || '/images/default-avatar.png' %>"
                    alt="Profile picture"
                    class="circle responsive-img"
                  />
                </div>
                <div class="col s8">
                  <div class="input-field">
                    <input
                      type="url"
                      id="avatarUrl"
                      name="avatarUrl"
                      value="<%= user.profile?.avatarUrl || '' %>"
                    />
                    <label for="avatarUrl">Profile Picture URL</label>
                  </div>
                </div>
              </div>
            </div>

            <!-- Basic Info Section -->
            <div class="section">
              <h5>Basic Information</h5>
              <div class="input-field">
                <input
                  type="text"
                  id="name"
                  name="name"
                  value="<%= user.profile?.name || '' %>"
                />
                <label for="name">Display Name</label>
              </div>

              <div class="input-field">
                <textarea id="bio" name="bio" class="materialize-textarea">
                                    <%= user.profile?.bio || '' %>
                                </textarea
                >
                <label for="bio">Bio</label>
              </div>

              <div class="input-field">
                <input
                  type="text"
                  id="location"
                  name="location"
                  value="<%= user.profile?.location || '' %>"
                />
                <label for="location">Location</label>
              </div>

              <div class="input-field">
                <input
                  type="text"
                  id="favoriteGenres"
                  name="favoriteGenres"
                  value="<%= user.profile?.favoriteGenres?.join(', ') || '' %>"
                />
                <label for="favoriteGenres"
                  >Favorite Genres (comma-separated)</label
                >
              </div>
            </div>

            <!-- Social Links Section -->
            <div class="section">
              <h5>Social Links</h5>
              <div class="input-field">
                <input
                  type="url"
                  id="discogsLink"
                  name="discogsLink"
                  value="<%= user.profile?.socialLinks?.discogs || '' %>"
                />
                <label for="discogsLink">Discogs Profile</label>
              </div>

              <div class="input-field">
                <input
                  type="url"
                  id="instagramLink"
                  name="instagramLink"
                  value="<%= user.profile?.socialLinks?.instagram || '' %>"
                />
                <label for="instagramLink">Instagram Profile</label>
              </div>

              <div class="input-field">
                <input
                  type="url"
                  id="twitterLink"
                  name="twitterLink"
                  value="<%= user.profile?.socialLinks?.twitter || '' %>"
                />
                <label for="twitterLink">Twitter Profile</label>
              </div>
            </div>

            <!-- Privacy Settings -->
            <div class="section">
              <h5>Privacy Settings</h5>
              <p>
                <label>
                  <input type="checkbox" name="isPublic" <%= user.isPublic ?
                  'checked' : '' %>>
                  <span>Make my collection public</span>
                </label>
              </p>
              <p>
                <label>
                  <input type="checkbox" name="showStats" <%=
                  user.profile?.showStats ? 'checked' : '' %>>
                  <span>Show my stats on my public profile</span>
                </label>
              </p>
            </div>

            <div class="card-action">
              <button type="submit" class="btn waves-effect waves-light">
                Save Settings
                <i class="material-icons right">save</i>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer.ejs') %>
