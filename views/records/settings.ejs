<%- include('../partials/header.ejs') %>

<div class="container">
  <div class="row">
    <div class="col s12 m8 offset-m2">
      <div class="card">
        <div class="card-content">
          <span class="card-title">Profile Settings</span>

          <% if (error) { %>
          <div class="card-panel red lighten-4 red-text text-darken-4">
            <%= error %>
          </div>
          <% } %>

          <form action="/records/settings" method="POST" enctype="multipart/form-data">
            <!-- Profile Picture Section -->
              <!-- Image Upload Section -->
              <div class="section">
                  <h5>Profile Images</h5>
                  <div class="row">
                      <div class="col s12 m6">
                          <h6>Profile Picture</h6>
                          <div class="file-field input-field">
                              <div class="btn">
                                  <span>Upload</span>
                                  <input type="file" name="profilePicture" accept="image/*">
                              </div>
                              <div class="file-path-wrapper">
                                  <input class="file-path validate" type="text">
                              </div>
                          </div>
                      </div>
                      <div class="col s12 m6">
                          <h6>Banner Image</h6>
                          <div class="file-field input-field">
                              <div class="btn">
                                  <span>Upload</span>
                                  <input type="file" name="bannerImage" accept="image/*">
                              </div>
                              <div class="file-path-wrapper">
                                  <input class="file-path validate" type="text">
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          
              <!-- Theme Toggle -->
              <div class="section">
                  <h5>Theme</h5>
                  <div class="switch">
                      <label>
                          Light
                          <input type="checkbox" name="darkMode" <%= user.profile?.theme === 'dark' ? 'checked' : '' %>>
                          <span class="lever"></span>
                          Dark
                      </label>
                  </div>
              </div>
          

            <!-- Basic Info Section -->
            <div class="section">
              <h5>Basic Information</h5>
              <div class="input-field">
                <input
                  type="text"
                  id="name"
                  name="name"
                  value="<%= user.profile?.name || '' %>"
                />
                <label for="name">Display Name</label>
              </div>

              <div class="input-field">
                <textarea id="bio" name="bio" class="materialize-textarea">
                                    <%= user.profile?.bio || '' %>
                                </textarea
                >
                <label for="bio">Bio</label>
              </div>

              <div class="input-field">
                <input
                  type="text"
                  id="location"
                  name="location"
                  value="<%= user.profile?.location || '' %>"
                />
                <label for="location">Location</label>
              </div>

              <div class="input-field">
                <input
                  type="text"
                  id="favoriteGenres"
                  name="favoriteGenres"
                  value="<%= user.profile?.favoriteGenres?.join(', ') || '' %>"
                />
                <label for="favoriteGenres"
                  >Favorite Genres (comma-separated)</label
                >
              </div>
            </div>

            <!-- Social Links Section -->
            <div class="section">
              <h5>Social Links</h5>
              <div class="input-field">
                <input
                  type="url"
                  id="discogsLink"
                  name="discogsLink"
                  value="<%= user.profile?.socialLinks?.discogs || '' %>"
                />
                <label for="discogsLink">Discogs Profile</label>
              </div>

              <div class="input-field">
                <input
                  type="url"
                  id="instagramLink"
                  name="instagramLink"
                  value="<%= user.profile?.socialLinks?.instagram || '' %>"
                />
                <label for="instagramLink">Instagram Profile</label>
              </div>

              <div class="input-field">
                <input
                  type="url"
                  id="twitterLink"
                  name="twitterLink"
                  value="<%= user.profile?.socialLinks?.twitter || '' %>"
                />
                <label for="twitterLink">Twitter Profile</label>
              </div>
            </div>

            <!-- Privacy Settings -->
            <div class="section">
              <h5>Privacy Settings</h5>
              <p>
                <label>
                  <input type="checkbox" name="isPublic" <%= user.isPublic ?
                  'checked' : '' %>>
                  <span>Make my collection public</span>
                </label>
              </p>
              <p>
                <label>
                  <input type="checkbox" name="showStats" <%=
                  user.showStats ? 'checked' : '' %>>
                  <span>Show my stats on my public profile</span>
                </label>
              </p>
            </div>

            <div class="card-action">
              <button type="submit" class="btn waves-effect waves-light">
                Save Settings
                <i class="material-icons right">save</i>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer.ejs') %>
